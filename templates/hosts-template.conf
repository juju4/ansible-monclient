## 20150308 JT Linux 

{% if targethost is defined and monclient_server is defined and targethost != monclient_server and true == false %}
## setup basic check alive directly in server config

object Host "{{ targethost }}" {
    import "generic-host"
    display_name = "{{ ansible_fqdn }}"
#    display_name = "{{ targethost }}"
    address = "{{ targethost }}"
{% if monclient_checkcommand is defined %}
   check_command   = "{{ monclient_checkcommand }}"
{% else %}
   check_command   = "hostalive"
{% endif %}
{% if monclient_group is defined %}
    groups += [ "{{ monclient_group }}" ]
{% endif %}

}
{% endif %}

object Service "SSH" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_ssh"
    enable_notifications = 0

}

object Service "users-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_users"
}

object Service "load-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_load"
}

object Service "partition root-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
## Note: rootdisk seems to take all mounted partition: got / + /vagrant
#    vars.ARG1 = "check_rootdisk"
    vars.ARG1 = "check_{{ monclient_partitionroot }}"
}

object Service "zombie procs-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_zombie_procs"
}

object Service "total procs-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_total_procs"
}

{% if monitor_mailq_postfix %}
object Service "mailq-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_mailq"
}
{% endif %}

{% if monitor_ntp %}
object Service "NTP-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_local_ntp"
}
{% endif %}

object Service "DNS www.google.com-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_local_dns_g"


}

object Service "DNS www.google.com - 8.8.8.8" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_local_dns_g2"
}

object Service "DNS www.yahoo.com" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_local_dns_y"
}

## FIXME! not sure if valid jinja2...   NOK TypeError: test_defined() takes exactly 1 argument (2 given)', 'failed': True
#{X% for item in ansible_mounts %}
#{X% if item.mount is defined item.mount == '/boot' -%}
#object Service "partition /boot" {
#    import "generic-service"
#    host_name = "{{ targethost }}"
#    check_command = "check_nrpe_1arg"
#    enable_notifications = 0
#    vars.ARG1 = "check_{X{ item.device }}"
#}

#{X% endif %}
#{X% endfor %}
#object Service "partition /home" {
#    import "generic-service"
#    host_name = "{{ targethost }}"
#    check_command = "check_nrpe_1arg"
#    enable_notifications = 0
#    vars.ARG1 = "check_home"
#}
#
#object Service "partition /tmp-n" {
#    import "generic-service"
#    host_name = "{{ targethost }}"
#    check_command = "check_nrpe_1arg"
#    enable_notifications = 0
#    vars.ARG1 = "check_tmp"
#}
#
#object Service "partition /var-n" {
#    import "generic-service"
#    host_name = "{{ targethost }}"
#    check_command = "check_nrpe_1arg"
#    enable_notifications = 0
#    vars.ARG1 = "check_var"
#}
#
#object Service "partition /var/log-n" {
#    import "generic-service"
#    host_name = "{{ targethost }}"
#    check_command = "check_nrpe_1arg"
#    enable_notifications = 0
#    vars.ARG1 = "check_var_log"
#}
#
#object Service "partition /var/tmp-n" {
#    import "generic-service"
#    host_name = "{{ targethost }}"
#    check_command = "check_nrpe_1arg"
#    enable_notifications = 0
#    vars.ARG1 = "check_var_tmp"
#}
#
object Service "swap-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_swap"
}

object Service "mem-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_mem"


}

{% if monitor_sensors %}
object Service "sensors-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_sensors"
}
{% endif %}

object Service "count file /tmp-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_ctmp"
}

object Service "count file /var/log-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_cvar_log"
}

object Service "count file /var/crash-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_cvar_crash"
}

object Service "Aide HIDS status-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_aide"
}

object Service "updates-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 0
    vars.ARG1 = "check_updates"
}

#object Service "File Age: oinkmaster.log-n" {
#    import "generic-service"
#    host_name = "{{ targethost }}"
#    check_command = "check_nrpe_1arg"
#    enable_notifications = 0
#    vars.ARG1 = "check_file_age_oinkmaster"
#}

#object Service "snort alerts-n" {
#    import "generic-service"
#    host_name = "{{ targethost }}"
#    check_command = "check_nrpe_1arg"
#    enable_notifications = 0
#    vars.ARG1 = "check_snortalerts"
#}

object Service "backup1-n" {
    import "generic-service"
    host_name = "{{ targethost }}"
    check_command = "check_nrpe_1arg"
    enable_notifications = 1
    vars.ARG1 = "check_backup1"
}



